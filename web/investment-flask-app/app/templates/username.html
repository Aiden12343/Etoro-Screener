{% extends "base.html" %}

{% block title %}User Performance{% endblock %}

{% block content %}

<!-- Include Tailwind CSS -->
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<style>
    body {
        background-color: #f0f0f0; /* Lighter gray background */
    }

    .sidebar {
        height: 100%;
        width: 60px;
        position: fixed;
        top: 0;
        left: 0;
        background-color: #1f2937; /* Dark gray background */
        overflow-x: hidden;
        padding-top: 60px;
    }

    .sidebar a {
        padding: 10px 15px;
        text-decoration: none;
        font-size: 18px;
        color: white;
        display: block;
        transition: 0.3s;
        text-align: center;
    }

    .sidebar a:hover {
        background-color: #4b5563; /* Lighter gray for hover */
    }

    .card {
        border: 2px solid #1f2937; /* Dark gray border */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background-color: #ffffff; /* White background */
        color: #1f2937; /* Dark gray text color */
        width: 100%; /* Adjust width to fit the container */
        margin-left: 0; /* Remove margin */
        overflow: hidden; /* Ensure content does not overflow */
    }

    .card-title {
        font-size: 24px;
        margin-bottom: 10px;
        text-align: center; /* Center the title */
    }

    .portfolio-container {
        margin: 0; /* Remove margin */
        padding: 0; /* Remove padding */
        overflow-y: auto; /* Add vertical scroll if content overflows */
    }

    .box-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start; /* Align items to the start */
        margin: 0; /* Remove margin */
        padding-left: 20px; /* Add padding to move the boxes to the left */
    }

    .box {
        flex: 1 1 calc(25% - 10px); /* 4 boxes per row with some spacing */
        margin: 5px;
        background-color: #e5e7eb; /* Light gray background */
        color: #1f2937; /* Dark gray text color */
        display: flex;
        flex-direction: column;
    }

    .pagination a {
        margin: 0 5px;
    }
</style>

<div id="mySidebar" class="sidebar">
    <a href="#" class="sidebar-btn">1</a>
    <a href="#" class="sidebar-btn">2</a>
    <a href="#" class="sidebar-btn">3</a>
    <a href="#" class="sidebar-btn">4</a>
</div>

<div class="main-content">
    <div class="box-container">
        <div class="box">
            <div class="card">
</div>

<div class="main-content">
    <div class="box-container">
        <div class="box double-height">
            <div class="card">
                <div class="card-title">Portfolio Breakdown</div>
                <div class="portfolio-container">
                    <table id="portfolio-table" class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-800 text-white">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"><a href="?sort=Ticker_name&order={{ next_order }}&page=1">Ticker Name</a></th>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"><a href="?sort=Direction&order={{ next_order }}&page=1">Direction</a></th>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"><a href="?sort=Invested&order={{ next_order }}&page=1">Invested</a></th>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"><a href="?sort=NetProfit&order={{ next_order }}&page=1">Net Profit</a></th>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"><a href="?sort=Value&order={{ next_order }}&page=1">Value</a></th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for position in portfolio_data %}
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap"><a href="{{ url_for('ticker', instrument_id=position.instrument_id) }}" class="text-indigo-600 hover:text-indigo-900">{{ position.TickerName }}</a></td>
                                <td class="px-6 py-4 whitespace-nowrap">{{ position.Direction }}</td>
                                <td class="px-6 py-4 whitespace-nowrap">{{ position.Invested }}</td>
                                <td class="px-6 py-4 whitespace-nowrap {{ 'text-green-500' if position.NetProfit >= 0 else 'text-red-500' }}">{{ position.NetProfit }}</td>
                                <td class="px-6 py-4 whitespace-nowrap {{ 'text-green-500' if position.Value >= 0 else 'text-red-500' }}">{{ position.Value }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <div class="pagination">
                        {% if page > 1 %}
                        <a href="?sort={{ sort_by }}&order={{ sort_order }}&page={{ page - 1 }}" class="btn btn-primary" onclick="storeScrollPosition()">&#8592;</a>
                        {% endif %}
                        {% if portfolio_data|length > 5 %}
                        <a href="?sort={{ sort_by }}&order={{ sort_order }}&page={{ page + 1 }}" class="btn btn-primary" onclick="storeScrollPosition()">&#8594;</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="box">
            <div class="card">
                <div class="card-title">Risk Contribution</div>
                <div class="portfolio-container">
                    <table id="risk-contribution-table" class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-800 text-white">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Ticker Name</th>
                                <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">% Contribution</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for risk in risk_contribution_data %}
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">{{ risk.ticker_name }}</td>
                                <td class="px-6 py-4 whitespace-nowrap">{{ risk.riskContributionPct }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="box">
            <div class="card">
                <div class="card-title">Card 3</div>
                <div class="portfolio-container"></div>
                    <!-- Content for Card 3 -->
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}
